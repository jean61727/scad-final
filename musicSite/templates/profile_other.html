{% extends 'profile.html' %}
{%block head%}
	<div style="margin-top:80px;"></div>
{%endblock%}
{%block image%}
	<img src='{{follow_user.user_image}}' class="img-circle img-responsive img-thumbnail" >
{%endblock%}
{%block name%}
<h3>{{ follow_user}}
	<input type="button" class="btn btn-success btn-xs" style="margin-left:10px" onclick='follow(this)' value='followed'/></h3>
{%endblock%}
{%block follow%}

{%endblock%}

{%block scripts%}
<script type="text/javascript">
	var videos =JSON.parse('{{ data|safe }}');
	var video_id_list=[];
	function playlist(user_post){
		
		for (var i=0;i<videos.length;i++){
			video_id_list[i]=videos[i].fields.url;

		}
		//console.log(videos);
		//console.log(videos[1]);
		var tag = document.createElement('script');
		tag.src = "https://www.youtube.com/iframe_api";
		var firstScriptTag = document.getElementsByTagName('script')[0];
		firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);
		var player;
		console.log("here2");
		
		var done = false;
		
		
	}


	window.onYouTubePlayerAPIReady=function() {
		player = new YT.Player('player', {
		  height: '390',
		  width: '640',
		 loadPlaylist:{
		    listType:'playlist',
		    list:video_id_list,
		    index:parseInt(0),
		    suggestedQuality:'small'
		 },
		  events: {
		    'onReady': onPlayerReady,
		    'onStateChange': onPlayerStateChange
		  }
		});
	}
	function onPlayerReady(event) {
		event.target.loadPlaylist(video_id_list);
	}
	function onPlayerStateChange(event) {
		if (event.data == YT.PlayerState.PLAYING && !done) {
		 // setTimeout(stopVideo, 60000);
		  done = true;
		}
	}
	function stopVideo() {
		player.stopVideo();
	}

	function follow(item){
		//var current_user={{user_other}};
		//console.log(current_user);
		if($(item).attr('value')=='followed'){
			$(item).prop('class','btn btn-primary btn-xs');
			$(item).prop('value','+follow');
			$.post('/unfollow/',{
				"follow":"{{follow_user}}"
			});
			
		
		}
		else{
			$(item).prop('class','btn btn-success btn-xs');
			$(item).prop('value','followed');
			$.post('/follow/',{
				"follow":"{{follow_user}}"
			});
			
		}
		
		
	}


</script>
{% endblock %}
